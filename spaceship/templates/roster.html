{% extends "base.html" %}

{% block title %}Roster - {{ super() }}{% endblock %}

{% block content %}
<h3>Team {{ team.name }} Roster</h3>

<table class="table-bordered">
<thead class="thead-dark">
  <tr>
    <th>Profile
    <th>Name
    <th>Email
</thead>
<tbody>
{% for user in roster: %}
  <tr>
    <td>
      <a href="{{ url_for('profile', user_id=user.id) }}">
        <img src="{{ gravatar(user.email, size=30) }}" width="30" height="30">
      </a>
    <td>{% if user.id == team.captain_id %}
          {{ user.name }} (Captain)
        {% else %}
          {{ user.name }}
        {% endif %}
    <td>{{ user.email }}
{% endfor %}
</tbody>
</table>

{% if is_captain %}

<h4>Crew Invitations</h4>

{% for invite in invitations: %}
  <div>
    {{ invite.invited_email }}
    {{ invite.status }}
    {{ invite.created_at }}
  </div>
{% endfor %}

<form method="POST" class="needs-validation" novalidate>
  {% for field in invite %}
  {% set errors = invite.errors[field.name] %}
  {% if field.flags.hidden %}
    {{ field(class="form-control") }}
  {% elif field.type == "SubmitField" %}
    {{ field(class="btn btn-primary") }}
  {% else %}
    {% if errors %}
    {% set class="form-control is-invalid" %}
    {% else %}
    {% set class="form-control" %}
    {% endif %}

    <div class="row">
      <span class="col-3">{{ field.label() }}</span>
    </div>
    <div class="row form-box">
      <span class="col-6">
      {{ field(class=class) }}
      <div class="invalid-feedback">
        {{ ';'.join(errors) }}
      </div>
      {{ field.description }}
      </span>
    </div>
  {% endif %}
  {% endfor %}
</form>

{% endif %}

{% endblock %}